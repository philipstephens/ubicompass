<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UBI Decile Calculator - Demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .card {
        border-radius: 24px;
        overflow: hidden;
        border: 1px solid #d0d6f7;
        background-color: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-top: 20px;
        margin-bottom: 20px;
      }
      .card-header {
        background-color: #673ab7;
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .card-title {
        font-weight: bold;
        font-size: 18px;
        margin: 0;
        color: white;
      }
      .card-content {
        padding: 20px;
      }
      .table-container {
        overflow-x: auto;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        padding: 8px 16px;
        text-align: left;
        border-bottom: 1px solid #e2e8f0;
      }
      th {
        background-color: #f8fafc;
        font-weight: 600;
      }
      tr:hover {
        background-color: #f1f5f9;
      }
      .decile-badge {
        background-color: #dbeafe;
        color: #1e40af;
        font-weight: 500;
        padding: 2px 8px;
        border-radius: 9999px;
        font-size: 0.875rem;
      }
      .income-bar,
      .ubi-bar {
        height: 16px;
        border-radius: 4px;
        min-width: 4px;
        transition: width 0.3s ease;
      }
      .income-bar {
        background-color: #3b82f6;
      }
      .ubi-bar {
        background-color: #10b981;
      }
      .footer-note {
        margin-top: 24px;
        padding: 16px;
        background-color: #f8fafc;
        border-radius: 8px;
        font-size: 0.875rem;
        color: #64748b;
      }
      .chart-container {
        width: 100%;
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .chart {
        display: flex;
        justify-content: space-around;
        align-items: flex-end;
        height: 380px;
        border-left: 2px solid #333;
        border-bottom: 2px solid #333;
        position: relative;
        margin-left: 80px;
        padding-right: 40px;
        width: 1200px;
        max-width: calc(100% - 120px);
        margin-bottom: 80px;
      }
      .break-even-line {
        position: absolute;
        left: 0;
        right: 0;
        border-top: 2px dashed #e74c3c;
        z-index: 5;
      }
      .break-even-label {
        position: absolute;
        right: -180px;
        background-color: #fef2f2;
        color: #e74c3c;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: bold;
        white-space: nowrap;
        border: 1px solid #e74c3c;
      }
      .tax-line {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 4;
      }
      .tax-point {
        position: absolute;
        width: 8px;
        height: 8px;
        background-color: #9333ea;
        border-radius: 50%;
        transform: translate(-50%, 50%);
      }
      .tax-label {
        position: absolute;
        background-color: #f3e8ff;
        color: #9333ea;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 10px;
        font-weight: bold;
        white-space: nowrap;
        border: 1px solid #9333ea;
        transform: translate(-50%, -100%);
        margin-top: -5px;
      }
      .y-axis {
        position: absolute;
        left: -50px;
        top: 0;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: flex-end;
        padding-right: 15px;
      }
      .y-axis-label {
        font-size: 14px;
        color: #333;
        font-weight: bold;
      }
      .grid-line {
        position: absolute;
        left: 0;
        right: 0;
        border-top: 1px dashed #ccc;
      }
      .x-axis {
        position: absolute;
        left: 0;
        right: 0;
        bottom: -60px;
        display: flex;
        justify-content: space-around;
      }
      .x-axis-label {
        text-align: center;
        font-size: 12px;
        width: 10%;
      }
      .bar-group {
        display: flex;
        width: 10%;
        justify-content: center;
        align-items: flex-end;
      }
      .bar {
        width: 40px;
        margin: 0 5px;
        position: relative;
        border-radius: 6px 6px 0 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        align-self: flex-end;
      }
      .bar-blue {
        background-color: #3b82f6;
        background-image: linear-gradient(to top, #3b82f6, #60a5fa);
      }
      .bar-green {
        background-color: #10b981;
        background-image: linear-gradient(to top, #10b981, #34d399);
      }
      .bar-value {
        position: absolute;
        top: -25px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 12px;
        font-weight: bold;
        color: #333;
      }
      .legend {
        display: flex;
        justify-content: center;
        margin-bottom: 15px;
      }
      .legend-item {
        display: flex;
        align-items: center;
        margin: 0 15px;
      }
      .legend-color {
        width: 20px;
        height: 20px;
        margin-right: 10px;
        border-radius: 4px;
      }
      .blue {
        background-color: #3b82f6;
      }
      .green {
        background-color: #10b981;
      }
      .axis-title {
        position: absolute;
        font-size: 16px;
        color: #333;
        font-weight: bold;
      }
      .y-axis-title {
        transform: rotate(-90deg);
        left: -90px;
        top: 50%;
        transform-origin: left top;
      }
      .x-axis-title {
        bottom: -90px;
        left: 50%;
        transform: translateX(-50%);
      }
      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 20px;
      }
      .control-group {
        flex: 1;
        min-width: 200px;
      }
      .view-toggle {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
      }
      .view-button {
        background-color: #673ab7;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        margin: 0 10px;
      }
      .view-button:hover {
        background-color: #5e35b1;
      }
      .view-button.active {
        background-color: #4527a0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="text-2xl font-bold mb-6">UBI by Income Decile - Demo</h1>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">UBI Calculator Parameters</h2>
        </div>
        <div class="card-content">
          <div class="controls">
            <div class="control-group">
              <label class="block mb-2 font-medium">Tax Year</label>
              <select
                id="taxYear"
                class="w-full p-2 border border-gray-300 rounded"
              >
                <option value="2022">2022</option>
                <option value="2023">2023</option>
              </select>
            </div>
            <div class="control-group">
              <label class="block mb-2 font-medium">UBI Amount</label>
              <select
                id="ubiAmount"
                class="w-full p-2 border border-gray-300 rounded"
              >
                <option value="12">$12k / Year ($1.0k / month)</option>
                <option value="18">$18k / Year ($1.5k / month)</option>
                <option value="24" selected>$24k / Year ($2.0k / month)</option>
                <option value="30">$30k / Year ($2.5k / month)</option>
                <option value="36">$36k / Year ($3.0k / month)</option>
              </select>
            </div>
            <div class="control-group">
              <label class="block mb-2 font-medium"
                >Flat Tax Percentage:
                <span id="taxPercentageValue">30%</span></label
              >
              <input
                type="range"
                id="taxPercentage"
                min="1"
                max="99"
                value="30"
                class="w-full"
              />
            </div>
            <div class="control-group">
              <label class="block mb-2 font-medium">Exemption Amount</label>
              <select
                id="exemptionAmount"
                class="w-full p-2 border border-gray-300 rounded"
              >
                <option value="0">$0k (No exemption)</option>
                <option value="12">$12k (No tax on first $12k)</option>
                <option value="18">$18k (No tax on first $18k)</option>
                <option value="24" selected>$24k (No tax on first $24k)</option>
                <option value="30">$30k (No tax on first $30k)</option>
                <option value="36">$36k (No tax on first $36k)</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="view-toggle">
        <button id="tableViewBtn" class="view-button">Table View</button>
        <button id="chartViewBtn" class="view-button active">Chart View</button>
      </div>

      <div class="card">
        <div class="card-header">
          <h2 class="card-title">UBI Impact by Income Decile</h2>
        </div>
        <div class="card-content">
          <div id="tableView" style="display: none">
            <h3 class="text-lg font-medium mb-4">
              Income Comparison by Decile
            </h3>

            <div class="table-container">
              <table class="w-full">
                <thead>
                  <tr>
                    <th class="py-2 px-4 border-b border-gray-200 text-left">
                      Decile
                    </th>
                    <th class="py-2 px-4 border-b border-gray-200 text-left">
                      Income Range
                    </th>
                    <th class="py-2 px-4 border-b border-gray-200 text-center">
                      Average Taxable Income
                    </th>
                    <th class="py-2 px-4 border-b border-gray-200 text-center">
                      Income with UBI
                    </th>
                  </tr>
                </thead>
                <tbody id="decileTableBody">
                  <!-- Table rows will be inserted here by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>

          <div id="chartView">
            <div class="chart-container">
              <h3 class="text-lg font-medium mb-4">
                Income Comparison by Decile
              </h3>

              <div class="legend">
                <div class="legend-item">
                  <div class="legend-color blue"></div>
                  <span class="legend-text">Average Taxable Income</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color green"></div>
                  <span class="legend-text">Income with UBI</span>
                </div>
                <div class="legend-item">
                  <div
                    style="
                      width: 20px;
                      height: 2px;
                      margin-right: 10px;
                      border-top: 2px dashed #e74c3c;
                    "
                  ></div>
                  <span class="legend-text" style="color: #e74c3c"
                    >Break-even Point</span
                  >
                </div>
                <div class="legend-item">
                  <div
                    style="
                      width: 20px;
                      height: 20px;
                      margin-right: 10px;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                    "
                  >
                    <div
                      style="
                        width: 8px;
                        height: 8px;
                        background-color: #9333ea;
                        border-radius: 50%;
                      "
                    ></div>
                  </div>
                  <span class="legend-text" style="color: #9333ea"
                    >Flat Tax Paid</span
                  >
                </div>
              </div>

              <div class="chart">
                <!-- Y-axis -->
                <div class="y-axis">
                  <div class="y-axis-label">$250k</div>
                  <div class="y-axis-label">$200k</div>
                  <div class="y-axis-label">$150k</div>
                  <div class="y-axis-label">$100k</div>
                  <div class="y-axis-label">$50k</div>
                  <div class="y-axis-label">$0k</div>
                </div>

                <!-- Y-axis title -->
                <div class="axis-title y-axis-title">Income (thousands)</div>

                <!-- Grid lines -->
                <div class="grid-line" style="top: 0%"></div>
                <div class="grid-line" style="top: 20%"></div>
                <div class="grid-line" style="top: 40%"></div>
                <div class="grid-line" style="top: 60%"></div>
                <div class="grid-line" style="top: 80%"></div>
                <div class="grid-line" style="top: 100%"></div>

                <!-- X-axis -->
                <div class="x-axis" id="chartXAxis">
                  <!-- Will be populated dynamically -->
                </div>

                <!-- X-axis title -->
                <div class="axis-title x-axis-title">Income Decile</div>
              </div>
            </div>
          </div>

          <div class="footer-note">
            <p>* All values are in thousands of dollars.</p>
            <p class="mt-2">
              Each decile represents exactly 10% of the taxpayer population.
              Deciles divide the population into ten equal groups based on
              income level, from lowest (D1) to highest (D10).
            </p>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Mock data for deciles
      const decileData = [
        {
          decile: 1,
          lowerBound: 0,
          upperBound: 10,
          averageTaxableIncome: 5,
        },
        {
          decile: 2,
          lowerBound: 10,
          upperBound: 20,
          averageTaxableIncome: 15,
        },
        {
          decile: 3,
          lowerBound: 20,
          upperBound: 30,
          averageTaxableIncome: 25,
        },
        {
          decile: 4,
          lowerBound: 30,
          upperBound: 40,
          averageTaxableIncome: 35,
        },
        {
          decile: 5,
          lowerBound: 40,
          upperBound: 50,
          averageTaxableIncome: 45,
        },
        {
          decile: 6,
          lowerBound: 50,
          upperBound: 60,
          averageTaxableIncome: 55,
        },
        {
          decile: 7,
          lowerBound: 60,
          upperBound: 70,
          averageTaxableIncome: 65,
        },
        {
          decile: 8,
          lowerBound: 70,
          upperBound: 100,
          averageTaxableIncome: 85,
        },
        {
          decile: 9,
          lowerBound: 100,
          upperBound: 150,
          averageTaxableIncome: 120,
        },
        {
          decile: 10,
          lowerBound: 150,
          upperBound: 500,
          averageTaxableIncome: 280,
        },
      ];

      // Get DOM elements
      const tableViewBtn = document.getElementById("tableViewBtn");
      const chartViewBtn = document.getElementById("chartViewBtn");
      const tableView = document.getElementById("tableView");
      const chartView = document.getElementById("chartView");
      const taxPercentage = document.getElementById("taxPercentage");
      const taxPercentageValue = document.getElementById("taxPercentageValue");
      const ubiAmount = document.getElementById("ubiAmount");
      const exemptionAmount = document.getElementById("exemptionAmount");

      // Set up event listeners
      tableViewBtn.addEventListener("click", () => {
        tableView.style.display = "block";
        chartView.style.display = "none";
        tableViewBtn.classList.add("active");
        chartViewBtn.classList.remove("active");
      });

      chartViewBtn.addEventListener("click", () => {
        tableView.style.display = "none";
        chartView.style.display = "block";
        chartViewBtn.classList.add("active");
        tableViewBtn.classList.remove("active");
      });

      taxPercentage.addEventListener("input", () => {
        taxPercentageValue.textContent = `${taxPercentage.value}%`;
        updateData();
      });

      ubiAmount.addEventListener("change", updateData);
      exemptionAmount.addEventListener("change", updateData);

      // Get decile description
      function getDecileDescription(decile) {
        switch (decile) {
          case 1:
            return "Lowest 10%";
          case 2:
            return "10-20%";
          case 3:
            return "20-30%";
          case 4:
            return "30-40%";
          case 5:
            return "40-50%";
          case 6:
            return "50-60%";
          case 7:
            return "60-70%";
          case 8:
            return "70-80%";
          case 9:
            return "80-90%";
          case 10:
            return "Highest 10%";
          default:
            return `Decile ${decile}`;
        }
      }

      // Calculate income with UBI
      function calculateIncomeWithUBI(income) {
        const ubi = parseInt(ubiAmount.value);
        return income + ubi;
      }

      // Calculate tax paid
      function calculateTaxPaid(income) {
        const taxRate = parseInt(taxPercentage.value) / 100;
        const exemptAmount = parseInt(exemptionAmount.value);
        const taxableIncome = Math.max(0, income - exemptAmount);
        return taxableIncome * taxRate;
      }

      // Calculate net UBI benefit (UBI amount - tax paid)
      function calculateNetUbiBenefit(income) {
        const ubi = parseInt(ubiAmount.value);
        const taxWithoutUbi = calculateTaxPaid(income);
        const taxWithUbi = calculateTaxPaid(income + ubi);
        const additionalTax = taxWithUbi - taxWithoutUbi;
        return ubi - additionalTax;
      }

      // Calculate break-even income (where UBI benefit equals tax paid)
      function calculateBreakEvenIncome() {
        const ubi = parseInt(ubiAmount.value);
        const taxRate = parseInt(taxPercentage.value) / 100;
        const exemptAmount = parseInt(exemptionAmount.value);

        // At break-even point: UBI = taxRate * (income + UBI - exemptAmount) - taxRate * (income - exemptAmount)
        // Simplifying: UBI = taxRate * UBI
        // Therefore: UBI * (1 - taxRate) = 0
        // This means at taxRate = 100%, everyone breaks even
        // For taxRate < 100%, we need to find where additional tax equals UBI

        // For flat tax with exemption:
        // Break-even occurs when: income = (UBI / taxRate) + exemptAmount - UBI
        return ubi / taxRate + exemptAmount - ubi;
      }

      // Update the table
      function updateTable() {
        const tableBody = document.getElementById("decileTableBody");
        tableBody.innerHTML = "";

        decileData.forEach((entry) => {
          const avgIncome = entry.averageTaxableIncome;
          const incomeWithUBI = calculateIncomeWithUBI(avgIncome);
          const incomeRange = `$${entry.lowerBound}k - $${entry.upperBound}k`;
          const description = getDecileDescription(entry.decile);

          const row = document.createElement("tr");
          row.className = "hover:bg-gray-50";

          row.innerHTML = `
                    <td class="py-2 px-4 border-b border-gray-200">
                        <span class="decile-badge">D${entry.decile}</span>
                    </td>
                    <td class="py-2 px-4 border-b border-gray-200">
                        ${description}
                        <span class="text-gray-500 text-sm ml-2">(${incomeRange})</span>
                    </td>
                    <td class="py-2 px-4 border-b border-gray-200 text-center">
                        <div class="flex items-center justify-center">
                            <div class="w-24 text-right font-medium mr-2">$${avgIncome}k</div>
                            <div class="income-bar" style="width: ${Math.min(avgIncome, 150)}px"></div>
                        </div>
                    </td>
                    <td class="py-2 px-4 border-b border-gray-200 text-center">
                        <div class="flex items-center justify-center">
                            <div class="w-24 text-right font-medium mr-2">$${incomeWithUBI}k</div>
                            <div class="ubi-bar" style="width: ${Math.min(incomeWithUBI, 150)}px"></div>
                        </div>
                    </td>
                `;

          tableBody.appendChild(row);
        });
      }

      // Update the chart
      function updateChart() {
        // Clear existing chart
        const chart = document.querySelector(".chart");
        const barGroups = document.querySelectorAll(".bar-group");
        barGroups.forEach((group) => group.remove());

        // Remove existing break-even line if it exists
        const existingBreakEvenLine =
          document.querySelector(".break-even-line");
        if (existingBreakEvenLine) {
          existingBreakEvenLine.remove();
        }

        // Remove existing tax line if it exists
        const existingTaxLine = document.querySelector(".tax-line");
        if (existingTaxLine) {
          existingTaxLine.remove();
        }

        // Clear x-axis
        const xAxis = document.getElementById("chartXAxis");
        xAxis.innerHTML = "";

        // Calculate maximum income for scaling
        const maxIncome = Math.max(
          ...decileData.map((entry) =>
            Math.max(
              entry.averageTaxableIncome,
              calculateIncomeWithUBI(entry.averageTaxableIncome)
            )
          )
        );

        // Calculate scale factor (80% of chart height)
        const chartHeight = 380;
        const scaleFactor = (chartHeight * 0.8) / maxIncome;

        // Update y-axis labels
        const yAxisLabels = document.querySelectorAll(".y-axis-label");
        const yMax = Math.ceil(maxIncome / 50) * 50;
        for (let i = 0; i < yAxisLabels.length; i++) {
          const value = (yMax * (5 - i)) / 5;
          yAxisLabels[i].textContent = `$${value}k`;
        }

        // Calculate break-even income
        const breakEvenIncome = calculateBreakEvenIncome();
        console.log("Break-even income:", breakEvenIncome);

        // Add break-even line if it's within the chart range
        if (breakEvenIncome > 0 && breakEvenIncome <= maxIncome) {
          // Calculate position as percentage of chart height
          const breakEvenPosition =
            (1 - (breakEvenIncome * scaleFactor) / chartHeight) * 100;

          // Create break-even line
          const breakEvenLine = document.createElement("div");
          breakEvenLine.className = "break-even-line";
          breakEvenLine.style.top = `${breakEvenPosition}%`;

          // Create break-even label
          const breakEvenLabel = document.createElement("div");
          breakEvenLabel.className = "break-even-label";
          breakEvenLabel.textContent = `Break-even: $${Math.round(breakEvenIncome)}k`;
          breakEvenLine.appendChild(breakEvenLabel);

          // Add line to chart
          chart.appendChild(breakEvenLine);
        }

        // Create tax line container
        const taxLine = document.createElement("div");
        taxLine.className = "tax-line";
        chart.appendChild(taxLine);

        // Calculate tax points for each decile
        const taxPoints = [];
        decileData.forEach((entry, index) => {
          const income = entry.averageTaxableIncome;
          const taxPaid = calculateTaxPaid(income);

          // Calculate position
          const xPos = (index + 0.5) * 10; // 10% width per decile
          const yPos = (1 - (taxPaid * scaleFactor) / chartHeight) * 100;

          taxPoints.push({ x: xPos, y: yPos, value: taxPaid });
        });

        // Draw tax points and connect them with lines
        taxPoints.forEach((point, index) => {
          // Create point
          const taxPoint = document.createElement("div");
          taxPoint.className = "tax-point";
          taxPoint.style.left = `${point.x}%`;
          taxPoint.style.top = `${point.y}%`;

          // Add label to every other point to avoid crowding
          if (index % 2 === 0) {
            const taxLabel = document.createElement("div");
            taxLabel.className = "tax-label";
            taxLabel.textContent = `$${Math.round(point.value)}k`;
            taxLabel.style.left = `${point.x}%`;
            taxLabel.style.top = `${point.y}%`;
            taxLine.appendChild(taxLabel);
          }

          taxLine.appendChild(taxPoint);

          // Connect points with lines (except for the first point)
          if (index > 0) {
            const prevPoint = taxPoints[index - 1];

            // Create line connecting to previous point
            const connector = document.createElement("div");
            connector.style.position = "absolute";
            connector.style.height = "2px";
            connector.style.backgroundColor = "#9333ea";
            connector.style.transformOrigin = "left center";

            // Calculate line position and dimensions
            const x1 = prevPoint.x;
            const y1 = prevPoint.y;
            const x2 = point.x;
            const y2 = point.y;

            // Calculate length and angle
            const length = Math.sqrt(
              Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2)
            );
            const angle = (Math.atan2(y2 - y1, x2 - x1) * 180) / Math.PI;

            // Set line properties
            connector.style.width = `${length}%`;
            connector.style.left = `${x1}%`;
            connector.style.top = `${y1}%`;
            connector.style.transform = `rotate(${angle}deg)`;

            taxLine.appendChild(connector);
          }
        });

        // Create bar groups for each decile
        decileData.forEach((entry, index) => {
          // Calculate bar heights
          const avgIncome = entry.averageTaxableIncome;
          const incomeWithUBI = calculateIncomeWithUBI(avgIncome);
          const avgHeight = avgIncome * scaleFactor;
          const ubiHeight = incomeWithUBI * scaleFactor;

          // Create bar group
          const barGroup = document.createElement("div");
          barGroup.className = "bar-group";

          // Create average income bar
          const avgBar = document.createElement("div");
          avgBar.className = "bar bar-blue";
          avgBar.style.height = `${avgHeight}px`;

          // Create bar value label
          const avgValue = document.createElement("div");
          avgValue.className = "bar-value";
          avgValue.textContent = `$${Math.round(avgIncome)}k`;
          avgBar.appendChild(avgValue);

          // Create UBI income bar
          const ubiBar = document.createElement("div");
          ubiBar.className = "bar bar-green";
          ubiBar.style.height = `${ubiHeight}px`;

          // Create bar value label
          const ubiValue = document.createElement("div");
          ubiValue.className = "bar-value";
          ubiValue.textContent = `$${Math.round(incomeWithUBI)}k`;
          ubiBar.appendChild(ubiValue);

          // Add bars to group
          barGroup.appendChild(avgBar);
          barGroup.appendChild(ubiBar);

          // Add bar group to chart
          chart.appendChild(barGroup);

          // Create x-axis label
          const xLabel = document.createElement("div");
          xLabel.className = "x-axis-label";

          // Create decile badge
          const badge = document.createElement("div");
          badge.className = "decile-badge";
          badge.textContent = `D${entry.decile}`;

          // Create decile description
          const desc = document.createElement("div");
          desc.className = "decile-desc";
          desc.textContent = getDecileDescription(entry.decile);

          // Add badge and description to label
          xLabel.appendChild(badge);
          xLabel.appendChild(desc);

          // Add label to x-axis
          xAxis.appendChild(xLabel);
        });
      }

      // Update all data
      function updateData() {
        updateTable();
        updateChart();
      }

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        updateData();
      });
    </script>
  </body>
</html>
