<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBI Chart Inspector Bookmarklet</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
        }
        h1, h2, h3 {
            color: #4a86e8;
        }
        h1 {
            border-bottom: 2px solid #4a86e8;
            padding-bottom: 10px;
        }
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        .instructions {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #4a86e8;
        }
        .bookmarklet {
            background-color: #4a86e8;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            text-decoration: none;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
        .bookmarklet:hover {
            background-color: #3a76d8;
        }
        .code-block {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Consolas', monospace;
            overflow-x: auto;
            white-space: pre-wrap;
            margin: 15px 0;
        }
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        .step {
            margin-bottom: 20px;
            padding-left: 20px;
            border-left: 2px solid #4a86e8;
        }
        .step-number {
            background-color: #4a86e8;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>UBI Chart Inspector Bookmarklet</h1>
        
        <div class="instructions">
            <h3>üìã What is this?</h3>
            <p>This is a bookmarklet that helps you inspect the UBI Chart component. A bookmarklet is a small JavaScript program that can be stored as a URL in a bookmark in your web browser.</p>
            <p>When you click the bookmarklet while viewing the UBI Calculator, it will analyze the chart component and provide detailed feedback in the browser console.</p>
        </div>
        
        <h2>How to Use</h2>
        
        <div class="step">
            <h3><span class="step-number">1</span> Add the Bookmarklet to Your Browser</h3>
            <p>Drag this link to your bookmarks bar:</p>
            <a href="javascript:(function(){function inspectChart(){console.clear();console.log('%cüìä UBI Chart Inspector','font-size:16px;font-weight:bold;color:#4a86e8');console.log(`üñ•Ô∏è Page URL: ${window.location.href}`);console.log(`üñ•Ô∏è Viewport: ${window.innerWidth}x${window.innerHeight}`);const chartComponent=findChartComponent();if(!chartComponent){console.error('‚ùå Chart component not found!');return}scrollToElement(chartComponent);console.log(`‚úÖ Found chart component`);inspectChartComponent(chartComponent);checkToggleButton();console.log('%cüèÅ Chart inspection complete','font-weight:bold;color:green')}function findChartComponent(){const selectors=['[data-component=chart]','.chart-container','.table-section','.calculation-table-container'];for(const selector of selectors){try{const elements=document.querySelectorAll(selector);if(elements.length>0){console.log(`‚úÖ Found using selector: ${selector}`);return elements[0]}}catch(e){}}const purpleHeaders=[...document.querySelectorAll('div[style*=\\'backgroundColor: \\"#673ab7\\"\\']')];if(purpleHeaders.length>0){console.log(`‚úÖ Found purple header`);return purpleHeaders[0].closest('div[style*=\\'borderRadius\\']')}return null}function scrollToElement(element){if(!element)return;const rect=element.getBoundingClientRect();const scrollTop=window.pageYOffset||document.documentElement.scrollTop;const targetPosition=rect.top+scrollTop-100;window.scrollTo({top:targetPosition,behavior:'smooth'});const originalOutline=element.style.outline;element.style.outline='3px solid red';setTimeout(()=>{element.style.outline=originalOutline},2000)}function inspectChartComponent(component){if(!component)return;console.log(`\nüìä Chart Component Inspection:`);const isChartView=checkIfChartView(component);console.log(`üìà Current view: ${isChartView?'Chart View':'Table View'}`);const rect=component.getBoundingClientRect();console.log(`üìè Dimensions: ${Math.round(rect.width)}x${Math.round(rect.height)}px`);const bars=findChartBars(component);console.log(`üßÆ Chart bars found: ${bars.length}`);if(bars.length>0){console.log(`üîç Bar details:`);bars.forEach((bar,index)=>{const barRect=bar.getBoundingClientRect();const height=Math.round(barRect.height);const color=getComputedStyle(bar).backgroundColor;console.log(`   Bar ${index+1}: Height=${height}px, Color=${color}`)})}const labels=findChartLabels(component);console.log(`üè∑Ô∏è Labels found: ${labels.length}`);logElementDetails(component)}function checkIfChartView(component){if(!component)return false;const hasChartBars=findChartBars(component).length>0;const hasTable=component.querySelector('table')!==null;return hasChartBars&&!hasTable}function findChartBars(component){if(!component)return[];return[...component.querySelectorAll('div[style*=\\'height\\'][style*=\\'\%\\']'),...component.querySelectorAll('div.bg-blue-500'),...component.querySelectorAll('div.bg-green-500'),...component.querySelectorAll('div[class*=\\'bar\\']')]}function findChartLabels(component){if(!component)return[];return[...component.querySelectorAll('div.text-xs'),...component.querySelectorAll('div[style*=\\'text-align: center\\']'),...component.querySelectorAll('div.font-bold')]}function checkToggleButton(){const toggleButtons=[...document.querySelectorAll('button svg[viewBox=\\'0 0 20 20\\']'),...document.querySelectorAll('button:has(svg)'),...document.querySelectorAll('span.chart-icon-container')];if(toggleButtons.length===0){console.log(`‚ùå Toggle button not found`);return}const toggleButton=toggleButtons[0].closest('button')||toggleButtons[0];console.log(`‚úÖ Found toggle button`);const buttonText=toggleButton.innerText.trim();if(buttonText){console.log(`üìù Button text: \\"${buttonText}\\"`)}const buttonRect=toggleButton.getBoundingClientRect();const isVisible=buttonRect.width>0&&buttonRect.height>0;console.log(`üëÅÔ∏è Button visibility: ${isVisible?'Visible':'Hidden'}`)}function logElementDetails(element){if(!element)return;console.log(`\nüîç Element Details:`);console.log(`üìù Tag name: ${element.tagName.toLowerCase()}`);console.log(`üìù Class list: ${element.className}`);const style=window.getComputedStyle(element);console.log(`üé® Background: ${style.backgroundColor}`);console.log(`üìè Width: ${style.width}`);console.log(`üìè Height: ${style.height}`);console.log(`üî≤ Border radius: ${style.borderRadius}`);console.log(`üìä Display: ${style.display}`);console.log(`üìä Position: ${style.position}`)}inspectChart()})();" class="bookmarklet">UBI Chart Inspector</a>
            <p class="note"><strong>Note:</strong> If you can't drag the link, right-click it, select "Add to bookmarks" or "Bookmark this link", and save it to your bookmarks bar.</p>
        </div>
        
        <div class="step">
            <h3><span class="step-number">2</span> Open the UBI Calculator</h3>
            <p>Navigate to the UBI Calculator at: <a href="http://localhost:5173" target="_blank">http://localhost:5173</a></p>
        </div>
        
        <div class="step">
            <h3><span class="step-number">3</span> Open the Browser Console</h3>
            <p>Open your browser's developer tools by pressing:</p>
            <ul>
                <li><strong>Chrome/Edge:</strong> F12 or Ctrl+Shift+J</li>
                <li><strong>Firefox:</strong> F12 or Ctrl+Shift+K</li>
                <li><strong>Safari:</strong> Cmd+Option+C</li>
            </ul>
            <p>Then click on the "Console" tab.</p>
        </div>
        
        <div class="step">
            <h3><span class="step-number">4</span> Run the Bookmarklet</h3>
            <p>Click the "UBI Chart Inspector" bookmarklet in your bookmarks bar while viewing the UBI Calculator.</p>
            <p>The script will:</p>
            <ul>
                <li>Find the chart component</li>
                <li>Scroll to it</li>
                <li>Highlight it briefly with a red outline</li>
                <li>Analyze its properties</li>
                <li>Output detailed information to the console</li>
            </ul>
        </div>
        
        <h2>What It Does</h2>
        <p>The Chart Inspector will provide information about:</p>
        <ul>
            <li>Whether the chart or table view is currently displayed</li>
            <li>The dimensions of the chart component</li>
            <li>The number of chart bars found and their properties</li>
            <li>The toggle button status</li>
            <li>Detailed styling information</li>
        </ul>
        
        <div class="note">
            <h3>Troubleshooting</h3>
            <p>If the bookmarklet doesn't work:</p>
            <ul>
                <li>Make sure the UBI Calculator is running at http://localhost:5173</li>
                <li>Check that JavaScript is enabled in your browser</li>
                <li>Try refreshing the page before running the bookmarklet</li>
                <li>Check the browser console for any errors</li>
            </ul>
        </div>
    </div>
    
    <div class="card">
        <h2>Manual Code</h2>
        <p>If you prefer to run the code manually, copy and paste this into your browser console while viewing the UBI Calculator:</p>
        <div class="code-block">
function inspectChart() {
  console.clear();
  console.log('%cüìä UBI Chart Inspector', 'font-size:16px;font-weight:bold;color:#4a86e8');
  console.log(`üñ•Ô∏è Page URL: ${window.location.href}`);
  console.log(`üñ•Ô∏è Viewport: ${window.innerWidth}x${window.innerHeight}`);
  
  const chartComponent = findChartComponent();
  
  if (!chartComponent) {
    console.error('‚ùå Chart component not found!');
    return;
  }
  
  scrollToElement(chartComponent);
  console.log(`‚úÖ Found chart component`);
  
  inspectChartComponent(chartComponent);
  checkToggleButton();
  
  console.log('%cüèÅ Chart inspection complete', 'font-weight:bold;color:green');
}

function findChartComponent() {
  const selectors = [
    '[data-component=chart]',
    '.chart-container',
    '.table-section',
    '.calculation-table-container'
  ];
  
  for (const selector of selectors) {
    try {
      const elements = document.querySelectorAll(selector);
      if (elements.length > 0) {
        console.log(`‚úÖ Found using selector: ${selector}`);
        return elements[0];
      }
    } catch (e) {}
  }
  
  const purpleHeaders = [...document.querySelectorAll('div[style*="backgroundColor: \\"#673ab7\\""]')];
  if (purpleHeaders.length > 0) {
    console.log(`‚úÖ Found purple header`);
    return purpleHeaders[0].closest('div[style*="borderRadius"]');
  }
  
  return null;
}

function scrollToElement(element) {
  if (!element) return;
  
  const rect = element.getBoundingClientRect();
  const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
  const targetPosition = rect.top + scrollTop - 100;
  
  window.scrollTo({
    top: targetPosition,
    behavior: 'smooth'
  });
  
  const originalOutline = element.style.outline;
  element.style.outline = '3px solid red';
  setTimeout(() => {
    element.style.outline = originalOutline;
  }, 2000);
}

function inspectChartComponent(component) {
  if (!component) return;
  
  console.log(`\nüìä Chart Component Inspection:`);
  
  const isChartView = checkIfChartView(component);
  console.log(`üìà Current view: ${isChartView ? 'Chart View' : 'Table View'}`);
  
  const rect = component.getBoundingClientRect();
  console.log(`üìè Dimensions: ${Math.round(rect.width)}x${Math.round(rect.height)}px`);
  
  const bars = findChartBars(component);
  console.log(`üßÆ Chart bars found: ${bars.length}`);
  
  if (bars.length > 0) {
    console.log(`üîç Bar details:`);
    bars.forEach((bar, index) => {
      const barRect = bar.getBoundingClientRect();
      const height = Math.round(barRect.height);
      const color = getComputedStyle(bar).backgroundColor;
      console.log(`   Bar ${index+1}: Height=${height}px, Color=${color}`);
    });
  }
  
  const labels = findChartLabels(component);
  console.log(`üè∑Ô∏è Labels found: ${labels.length}`);
  
  logElementDetails(component);
}

function checkIfChartView(component) {
  if (!component) return false;
  
  const hasChartBars = findChartBars(component).length > 0;
  const hasTable = component.querySelector('table') !== null;
  
  return hasChartBars && !hasTable;
}

function findChartBars(component) {
  if (!component) return [];
  
  return [
    ...component.querySelectorAll('div[style*="height"][style*="%"]'),
    ...component.querySelectorAll('div.bg-blue-500'),
    ...component.querySelectorAll('div.bg-green-500'),
    ...component.querySelectorAll('div[class*="bar"]'),
  ];
}

function findChartLabels(component) {
  if (!component) return [];
  
  return [
    ...component.querySelectorAll('div.text-xs'),
    ...component.querySelectorAll('div[style*="text-align: center"]'),
    ...component.querySelectorAll('div.font-bold'),
  ];
}

function checkToggleButton() {
  const toggleButtons = [
    ...document.querySelectorAll('button svg[viewBox="0 0 20 20"]'),
    ...document.querySelectorAll('button:has(svg)'),
    ...document.querySelectorAll('span.chart-icon-container'),
  ];
  
  if (toggleButtons.length === 0) {
    console.log(`‚ùå Toggle button not found`);
    return;
  }
  
  const toggleButton = toggleButtons[0].closest('button') || toggleButtons[0];
  console.log(`‚úÖ Found toggle button`);
  
  const buttonText = toggleButton.innerText.trim();
  if (buttonText) {
    console.log(`üìù Button text: "${buttonText}"`);
  }
  
  const buttonRect = toggleButton.getBoundingClientRect();
  const isVisible = buttonRect.width > 0 && buttonRect.height > 0;
  console.log(`üëÅÔ∏è Button visibility: ${isVisible ? 'Visible' : 'Hidden'}`);
}

function logElementDetails(element) {
  if (!element) return;
  
  console.log(`\nüîç Element Details:`);
  console.log(`üìù Tag name: ${element.tagName.toLowerCase()}`);
  console.log(`üìù Class list: ${element.className}`);
  
  const style = window.getComputedStyle(element);
  console.log(`üé® Background: ${style.backgroundColor}`);
  console.log(`üìè Width: ${style.width}`);
  console.log(`üìè Height: ${style.height}`);
  console.log(`üî≤ Border radius: ${style.borderRadius}`);
  console.log(`üìä Display: ${style.display}`);
  console.log(`üìä Position: ${style.position}`);
}

inspectChart();
        </div>
    </div>
</body>
</html>
